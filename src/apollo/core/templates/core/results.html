{% extends "core/layout.html" %}
{% load apollo %}{% load analysis %}{% load i18n %}
{% block content %}
<div class="row">
    <div class="col-md-9">
    	{% analysis_breadcrumb_navigation form location None 'results' %}
    </div>
    <div class="col-md-3">
    	<form class="form-inline pull-right" action="" method="get" accept-charset="utf-8">
          <div class="form-group form-container">{{ filter_form.sample }}</div>
          <button class="btn btn-warning" type="submit"><i class="glyphicon glyphicon-search"></i> {% trans "Filter" context "verb" %}</button>
        </form>
    </div>
</div>
<div class="row">
    <div class="col-md-12">
        <ul class="nav nav-tabs">
          {% for section in analysis_sections %}
          <li{% if forloop.first %} class="active"{% endif %}><a href="#tab_{{ section.pk }}" data-toggle="tab">{% trans section.name %}</a></li>
          {% endfor %}
        </ul>
        <div class="tab-content" style="overflow:auto;">
            {% for section in analysis_sections %}
            <div class="tab-pane{% if forloop.first %} active{% endif %}" id="tab_{{ section.pk }}">
                {% if form.votes %}
                <table class="table-responsive">
                    <table class="table table-bordered table-hover">
                        <tr>
                            <th width="200" rowspan="2" {% if form.options.has_urban %}colspan="2"{% endif %} style="vertical-align:middle" class="gray">&nbsp;</th>
                            <th class="gray">&nbsp;</th>
                            <th class="gray">&nbsp;</th>
                            {% if form.options.voters_in_register %}
                            <th class="gray">&nbsp;</th>
                            {% endif %}
                            <th width="30"{% if form.options.voters_in_register and form.options.has_moe %} colspan="2"{% endif %} class="gray" style="text-align:center">{% trans "Total Votes" %}</th>
                            <th width="100" {% if form.options.has_moe %}colspan="2"{% endif %} class="gray" style="text-align:center">{% trans "Rejected Ballots" %}</th>
                            <th width="30" class="gray" style="text-align:center">{% trans "Total Valid" %}</th>
                            {% for party in form.parties %}
                            <th width="100" {% if form.options.has_moe %}colspan="2"{% endif %} class="gray" style="text-align:center">{{ party|safe }}</th>
                            {% endfor %}
                        </tr>
                        <tr>
                            <td class="centered" width="10%"><em>{% trans "Reported" %}</em></td>
                            <td class="centered" width="10%"><em>{% trans "Missing" %}</em></td>
                            {% if form.options.voters_in_register %}
                            <td class="centered" width="10%"><em><abbr title="{% trans "Total Registered" %}">{% trans "TR" context "abbreviation for total registered" %}</abbr></em></td>
                            {% endif %}
                            <td class="centered" width="10%"><em>{% trans "Votes" %}</em></td>
                            {% if form.options.voters_in_register and form.options.has_moe %}
                            <td class="centered"><em><abbr title="{% trans 'Margin of Error' %}">{% trans "MoE" context "abbreviation for margin of error" %}</abbr></em></td>
                            {% endif %}
                            <td class="centered"><em><abbr title="{% trans 'Rejected Ballots' %}">{% trans "RB" context "abbreviation for rejected ballots" %}</abbr></em></td>
                            {% if form.options.has_moe %}<td class="centered"><em><abbr title="{% trans 'Margin of Error' %}">{% trans "MoE" context "abbreviation for margin of error" %}</abbr></em></td>{% endif %}
                            <td class="centered"><em><abbr title="{% trans 'Total Valid' %}">{% trans "TV" context "abbreviation for total votes" %}</abbr></em></td>
                            {% for party in form.parties %}
                            <td class="centered"><em>{% trans "Votes" %}</em></td>
                            {% if form.options.has_moe %}<td class="centered"><em><abbr title="{% trans 'Margin of Error' %}">{% trans "MoE" context "abbreviation for margin of error" %}</abbr></em></td>{% endif %}
                            {% endfor %}
                        </tr>
                        <tr>
                            <th class="gray" {% if form.options.has_urban %}rowspan="3"{% endif %} style="vertical-align:middle">{{ location.name }} · <span class="muted"><em>{{ location.type }}</em></span></th>
                            {% if form.options.has_urban %}<th width="50" class="gray">{% trans "All" %}</th>{% endif %}
                            <th class="numeric gray">{% reported_pct dataframe form.votes location.type.name location.name 'ALL' %}% <br />({% reported dataframe form.votes location.type.name location.name 'ALL' %})</th>
                            <th class="numeric gray">{% missing_pct dataframe form.votes location.type.name location.name 'ALL' %}% <br />({% missing dataframe form.votes location.type.name location.name 'ALL' %})</th>
                            {% if form.options.voters_in_register %}
                            <th class="numeric gray">{% total_registered dataframe form location.type.name location.name 'ALL' %}</th>
                            {% endif %}
                            <th class="numeric gray">{% all_votes_total_pct dataframe form form.votes location.type.name location.name 'ALL' %}%<br />({% all_votes_total dataframe form form.votes location.type.name location.name 'ALL' %})</th>
                            {% if form.options.voters_in_register and form.options.has_moe %}
                            <th class="numeric gray">{% all_votes_total_margin_of_error dataframe form form.votes location.type.name location.name 'ALL' %}%</th>
                            {% endif %}
                            <th class="numeric gray">{% rejected_proportion form dataframe location.type.name location.name 'ALL' %}%<br />({% rejected_count form dataframe location.type.name location.name 'ALL' %})</th>
                            {% if form.options.has_moe %}<th class="numeric gray">{% rejected_margin_of_error form dataframe location.type.name location.name 'ALL' %}%</th>{% endif %}
                            <th class="numeric gray">{% valid_votes_total dataframe form.votes location.type.name location.name 'ALL' %}</th>
                            {% for vote in form.votes %}
                            <th class="numeric gray">{% vote_proportion dataframe form form.votes vote location.type.name location.name 'ALL' %}%<br />({% vote_count dataframe form.votes vote location.type.name location.name 'ALL' %})</th>
                            {% if form.options.has_moe %}<th class="numeric gray">{% vote_margin_of_error dataframe form form.votes vote location.type.name location.name 'ALL' %}%</th>{% endif %}
                            {% endfor %}
                        </tr>
                        {% if form.options.has_urban %}
                        <tr>
                            <td>{% trans "Rural" %}</td>
                            <td class="numeric">{% reported_pct dataframe form.votes location.type.name location.name 'RURAL' %}% <br />({% reported dataframe form.votes location.type.name location.name 'RURAL' %})</td>
                            <td class="numeric">{% missing_pct dataframe form.votes location.type.name location.name 'RURAL' %}% <br />({% missing dataframe form.votes location.type.name location.name 'RURAL' %})</td>
                            {% if form.options.voters_in_register %}
                            <th class="numeric">{% total_registered dataframe form location.type.name location.name 'RURAL' %}</th>
                            {% endif %}
                            <td class="numeric">{% all_votes_total_pct dataframe form form.votes location.type.name location.name 'RURAL' %}%<br />({% all_votes_total dataframe form form.votes location.type.name location.name 'RURAL' %})</td>
                            {% if form.options.voters_in_register and form.options.has_moe %}
                            <td class="numeric">{% all_votes_total_margin_of_error dataframe form form.votes location.type.name location.name 'RURAL' %}%</td>
                            {% endif %}
                            <td class="numeric">{% rejected_proportion form dataframe location.type.name location.name 'RURAL' %}% <br />({% rejected_count form dataframe location.type.name location.name 'RURAL' %})</td>
                            {% if form.options.has_moe %}<td class="numeric">{% rejected_margin_of_error form dataframe location.type.name location.name 'RURAL' %}%</td>{% endif %}
                            <td class="numeric">{% valid_votes_total dataframe form.votes location.type.name location.name 'RURAL' %}</td>
                            {% for vote in form.votes %}
                            <td class="numeric">{% vote_proportion dataframe form form.votes vote location.type.name location.name 'RURAL' %}% <br />({% vote_count dataframe form.votes vote location.type.name location.name 'RURAL' %})</td>
                            {% if form.options.has_moe %}<td class="numeric">{% vote_margin_of_error dataframe form form.votes vote location.type.name location.name 'RURAL' %}%</td>{% endif %}
                            {% endfor %}
                        </tr>
                        <tr>
                            <td>{% trans "Urban" %}</td>
                            <td class="numeric">{% reported_pct dataframe form.votes location.type.name location.name 'URBAN' %}% <br />({% reported dataframe form.votes location.type.name location.name 'URBAN' %})</td>
                            <td class="numeric">{% missing_pct dataframe form.votes location.type.name location.name 'URBAN' %}% <br />({% missing dataframe form.votes location.type.name location.name 'URBAN' %})</td>
                            {% if form.options.voters_in_register %}
                            <th class="numeric">{% total_registered dataframe form location.type.name location.name 'URBAN' %}</th>
                            {% endif %}
                            <td class="numeric">{% all_votes_total_pct dataframe form form.votes location.type.name location.name 'URBAN' %}%<br />({% all_votes_total dataframe form form.votes location.type.name location.name 'URBAN' %})</td>
                            {% if form.options.voters_in_register and form.options.has_moe %}
                            <td class="numeric">{% all_votes_total_margin_of_error dataframe form form.votes location.type.name location.name 'URBAN' %}%</td>
                            {% endif %}
                            <td class="numeric">{% rejected_proportion form dataframe location.type.name location.name 'URBAN' %}% <br />({% rejected_count form dataframe location.type.name location.name 'URBAN' %})</td>
                            {% if form.options.has_moe %}<td class="numeric">{% rejected_margin_of_error form dataframe location.type.name location.name 'URBAN' %}%</td>{% endif %}
                            <td class="numeric">{% valid_votes_total dataframe form.votes location.type.name location.name 'URBAN' %}</td>
                            {% for vote in form.votes %}
                            <td class="numeric">{% vote_proportion dataframe form form.votes vote location.type.name location.name 'URBAN' %}% <br />({% vote_count dataframe form.votes vote location.type.name location.name 'URBAN' %})</td>
                            {% if form.options.has_moe %}<td class="numeric">{% vote_margin_of_error dataframe form form.votes vote location.type.name location.name 'URBAN' %}%</td>{% endif %}
                            {% endfor %}
                        </tr>
                        {% endif %}
                        {% for sublocation in section.location_set.all %}
                        <tr>
                            <td class="gray" {% if form.options.has_urban %}rowspan="3"{% endif %} style="vertical-align:middle">{{ sublocation.name }} · <span class="muted"><em>{{ sublocation.type }}</em></span></td>
                            {% if form.options.has_urban %}<th width="50" class="gray">{% trans "All" %}</th>{% endif %}
                            <th class="numeric gray">{% reported_pct dataframe form.votes sublocation.type.name sublocation.name 'ALL' %}% <br />({% reported dataframe form.votes sublocation.type.name sublocation.name 'ALL' %})</th>
                            <th class="numeric gray">{% missing_pct dataframe form.votes sublocation.type.name sublocation.name 'ALL' %}% <br />({% missing dataframe form.votes sublocation.type.name sublocation.name 'ALL' %})</th>
                            {% if form.options.voters_in_register %}
                            <th class="numeric gray">{% total_registered dataframe form sublocation.type.name sublocation.name 'ALL' %}</th>
                            {% endif %}
                            <th class="numeric gray">{% all_votes_total_pct dataframe form form.votes sublocation.type.name sublocation.name 'ALL' %}%<br />({% all_votes_total dataframe form form.votes sublocation.type.name sublocation.name 'ALL' %})</th>
                            {% if form.options.voters_in_register and form.options.has_moe %}
                            <th class="numeric gray">{% all_votes_total_margin_of_error dataframe form form.votes sublocation.type.name sublocation.name 'ALL' %}%</th>
                            {% endif %}
                            <th class="numeric gray">{% rejected_proportion form dataframe sublocation.type.name sublocation.name 'ALL' %}% <br />({% rejected_count form dataframe sublocation.type.name sublocation.name 'ALL' %})</th>
                            {% if form.options.has_moe %}<th class="numeric gray">{% rejected_margin_of_error form dataframe sublocation.type.name sublocation.name 'ALL' %}%</th>{% endif %}
                            <th class="numeric gray">{% valid_votes_total dataframe form.votes sublocation.type.name sublocation.name 'ALL' %}</th>
                            {% for vote in form.votes %}
                            <th class="numeric gray">{% vote_proportion dataframe form form.votes vote sublocation.type.name sublocation.name 'ALL' %}% <br />({% vote_count dataframe form.votes vote sublocation.type.name sublocation.name 'ALL' %})</th>
                            {% if form.options.has_moe %}<th class="numeric gray">{% vote_margin_of_error dataframe form form.votes vote sublocation.type.name sublocation.name 'ALL' %}%</th>{% endif %}
                            {% endfor %}
                        </tr>
                        {% if form.options.has_urban %}
                        <tr>
                            <td>{% trans "Rural" %}</td>
                            <td class="numeric">{% reported_pct dataframe form.votes sublocation.type.name sublocation.name 'RURAL' %}% <br />({% reported dataframe form.votes sublocation.type.name sublocation.name 'RURAL' %})</td>
                            <td class="numeric">{% missing_pct dataframe form.votes sublocation.type.name sublocation.name 'RURAL' %}% <br />({% missing dataframe form.votes sublocation.type.name sublocation.name 'RURAL' %})</td>
                            {% if form.options.voters_in_register %}
                            <th class="numeric">{% total_registered dataframe form sublocation.type.name sublocation.name 'RURAL' %}</th>
                            {% endif %}
                            <td class="numeric">{% all_votes_total_pct dataframe form form.votes sublocation.type.name sublocation.name 'RURAL' %}%<br />({% all_votes_total dataframe form form.votes sublocation.type.name sublocation.name 'RURAL' %})</td>
                            {% if form.options.voters_in_register and form.options.has_moe %}
                            <td class="numeric">{% all_votes_total_margin_of_error dataframe form form.votes sublocation.type.name sublocation.name 'RURAL' %}%</td>
                            {% endif %}
                            <td class="numeric">{% rejected_proportion form dataframe sublocation.type.name sublocation.name 'RURAL' %}% <br />({% rejected_count form dataframe sublocation.type.name sublocation.name 'RURAL' %})</td>
                            {% if form.options.has_moe %}<td class="numeric">{% rejected_margin_of_error form dataframe sublocation.type.name sublocation.name 'RURAL' %}%</td>{% endif %}
                            <td class="numeric">{% valid_votes_total dataframe form.votes sublocation.type.name sublocation.name 'RURAL' %}</td>
                            {% for vote in form.votes %}
                            <td class="numeric">{% vote_proportion dataframe form form.votes vote sublocation.type.name sublocation.name 'RURAL' %}% <br />({% vote_count dataframe form.votes vote sublocation.type.name sublocation.name 'RURAL' %})</td>
                            {% if form.options.has_moe %}<td class="numeric">{% vote_margin_of_error dataframe form form.votes vote sublocation.type.name sublocation.name 'RURAL' %}%</td>{% endif %}
                            {% endfor %}
                        </tr>
                        <tr>
                            <td>{% trans "Urban" %}</td>
                            <td class="numeric">{% reported_pct dataframe form.votes sublocation.type.name sublocation.name 'URBAN' %}% <br />({% reported dataframe form.votes sublocation.type.name sublocation.name 'URBAN' %})</td>
                            <td class="numeric">{% missing_pct dataframe form.votes sublocation.type.name sublocation.name 'URBAN' %}% <br />({% missing dataframe form.votes sublocation.type.name sublocation.name 'URBAN' %})</td>
                            {% if form.options.voters_in_register %}
                            <th class="numeric">{% total_registered dataframe form sublocation.type.name sublocation.name 'URBAN' %}</th>
                            {% endif %}
                            <td class="numeric">{% all_votes_total_pct dataframe form form.votes sublocation.type.name sublocation.name 'URBAN' %}%<br />({% all_votes_total dataframe form form.votes sublocation.type.name sublocation.name 'URBAN' %})</td>
                            {% if form.options.voters_in_register and form.options.has_moe %}
                            <td class="numeric">{% all_votes_total_margin_of_error dataframe form form.votes sublocation.type.name sublocation.name 'URBAN' %}%</td>
                            {% endif %}
                            <td class="numeric">{% rejected_proportion form dataframe sublocation.type.name sublocation.name 'URBAN' %}% <br />({% rejected_count form dataframe sublocation.type.name sublocation.name 'URBAN' %})</td>
                            {% if form.options.has_moe %}<td class="numeric">{% rejected_margin_of_error form dataframe sublocation.type.name sublocation.name 'URBAN' %}%</td>{% endif %}
                            <td class="numeric">{% valid_votes_total dataframe form.votes sublocation.type.name sublocation.name 'URBAN' %}</td>
                            {% for vote in form.votes %}
                            <td class="numeric">{% vote_proportion dataframe form form.votes vote sublocation.type.name sublocation.name 'URBAN' %}% <br />({% vote_count dataframe form.votes vote sublocation.type.name sublocation.name 'URBAN' %})</td>
                            {% if form.options.has_moe %}<td class="numeric">{% vote_margin_of_error dataframe form form.votes vote sublocation.type.name sublocation.name 'URBAN' %}%</td>{% endif %}
                            {% endfor %}
                        </tr>
                        {% endif %}
                        {% endfor %}
                    </table>
                </table>
                {% else %}
                <table width="100%" class="table table-striped table-bordered">
                    <tr class="warning"><td style="text-align:center">{% trans "No Data Available" %}</td></tr>
                </table>
                {% endif %}
            </div>
            {% endfor %}
            </div>
        </div>
    </div>
</div>
{% endblock %}
